diff --git a/.idea/workspace.xml b/.idea/workspace.xml
index 3f5ffa1..146a77a 100644
--- a/.idea/workspace.xml
+++ b/.idea/workspace.xml
@@ -2,12 +2,11 @@
 <project version="4">
   <component name="ChangeListManager">
     <list default="true" id="1ee1d377-c5f6-4a49-ab4a-7f8de3e2602f" name="Default" comment="">
-      <change beforePath="$PROJECT_DIR$/.gitignore" afterPath="$PROJECT_DIR$/.gitignore" />
+      <change beforePath="" afterPath="$PROJECT_DIR$/darknet_cnn.py" />
+      <change beforePath="" afterPath="$PROJECT_DIR$/darknet_flags.py" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" afterPath="$PROJECT_DIR$/.idea/workspace.xml" />
-      <change beforePath="$PROJECT_DIR$/cnn.py" afterPath="$PROJECT_DIR$/cnn.py" />
       <change beforePath="$PROJECT_DIR$/common_flags.py" afterPath="$PROJECT_DIR$/common_flags.py" />
-      <change beforePath="$PROJECT_DIR$/model/a.diff" afterPath="$PROJECT_DIR$/model/a.diff" />
-      <change beforePath="$PROJECT_DIR$/model/weights_001.h5" afterPath="$PROJECT_DIR$/model/weights_001.h5" />
+      <change beforePath="$PROJECT_DIR$/darknet_models.py" afterPath="$PROJECT_DIR$/darknet_models.py" />
       <change beforePath="$PROJECT_DIR$/run_this.sh" afterPath="$PROJECT_DIR$/run_this.sh" />
     </list>
     <option name="EXCLUDED_CONVERTED_TO_IGNORED" value="true" />
@@ -23,11 +22,23 @@
   </component>
   <component name="FileEditorManager">
     <leaf SIDE_TABS_SIZE_LIMIT_KEY="300">
-      <file leaf-file-name="cnn.py" pinned="false" current-in-tab="true">
+      <file leaf-file-name="cnn.py" pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/cnn.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="378">
-              <caret line="87" column="46" lean-forward="true" selection-start-line="87" selection-start-column="46" selection-end-line="87" selection-end-column="46" />
+            <state relative-caret-position="2880">
+              <caret line="160" column="59" lean-forward="false" selection-start-line="160" selection-start-column="41" selection-end-line="160" selection-end-column="59" />
+              <folding>
+                <element signature="e#38#61#0" expanded="true" />
+              </folding>
+            </state>
+          </provider>
+        </entry>
+      </file>
+      <file leaf-file-name="darknet_cnn.py" pinned="false" current-in-tab="false">
+        <entry file="file://$PROJECT_DIR$/darknet_cnn.py">
+          <provider selected="true" editor-type-id="text-editor">
+            <state relative-caret-position="-348">
+              <caret line="46" column="4" lean-forward="false" selection-start-line="46" selection-start-column="4" selection-end-line="46" selection-end-column="4" />
               <folding>
                 <element signature="e#38#61#0" expanded="true" />
               </folding>
@@ -38,8 +49,8 @@
       <file leaf-file-name="run_this.sh" pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/run_this.sh">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="108">
-              <caret line="6" column="13" lean-forward="false" selection-start-line="6" selection-start-column="13" selection-end-line="6" selection-end-column="13" />
+            <state relative-caret-position="180">
+              <caret line="10" column="21" lean-forward="false" selection-start-line="10" selection-start-column="21" selection-end-line="10" selection-end-column="21" />
               <folding />
             </state>
           </provider>
@@ -48,8 +59,8 @@
       <file leaf-file-name="utils.py" pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/utils.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="837">
-              <caret line="338" column="18" lean-forward="false" selection-start-line="338" selection-start-column="12" selection-end-line="338" selection-end-column="18" />
+            <state relative-caret-position="0">
+              <caret line="0" column="0" lean-forward="false" selection-start-line="0" selection-start-column="0" selection-end-line="1" selection-end-column="14" />
               <folding>
                 <element signature="e#38#47#0" expanded="true" />
               </folding>
@@ -60,8 +71,8 @@
       <file leaf-file-name="cnn_models.py" pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/cnn_models.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="162">
-              <caret line="9" column="6" lean-forward="false" selection-start-line="9" selection-start-column="6" selection-end-line="9" selection-end-column="6" />
+            <state relative-caret-position="594">
+              <caret line="33" column="45" lean-forward="false" selection-start-line="33" selection-start-column="36" selection-end-line="33" selection-end-column="45" />
               <folding>
                 <element signature="e#0#12#0" expanded="true" />
               </folding>
@@ -69,63 +80,33 @@
           </provider>
         </entry>
       </file>
-      <file leaf-file-name="darknet_models.py" pinned="false" current-in-tab="false">
+      <file leaf-file-name="darknet_models.py" pinned="false" current-in-tab="true">
         <entry file="file://$PROJECT_DIR$/darknet_models.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="1440">
-              <caret line="80" column="20" lean-forward="false" selection-start-line="80" selection-start-column="20" selection-end-line="80" selection-end-column="20" />
+            <state relative-caret-position="936">
+              <caret line="79" column="61" lean-forward="false" selection-start-line="79" selection-start-column="61" selection-end-line="79" selection-end-column="61" />
               <folding>
-                <element signature="e#0#12#0" expanded="true" />
+                <element signature="e#38#50#0" expanded="true" />
               </folding>
             </state>
           </provider>
         </entry>
       </file>
-      <file leaf-file-name="merge.py" pinned="false" current-in-tab="false">
-        <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/layers/merge.py">
-          <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="137">
-              <caret line="521" column="4" lean-forward="false" selection-start-line="521" selection-start-column="4" selection-end-line="521" selection-end-column="4" />
-              <folding />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file leaf-file-name="core.py" pinned="false" current-in-tab="false">
-        <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/layers/core.py">
-          <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="399">
-              <caret line="299" column="35" lean-forward="false" selection-start-line="299" selection-start-column="35" selection-end-line="299" selection-end-column="35" />
-              <folding />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file leaf-file-name="activations.py" pinned="false" current-in-tab="false">
-        <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/activations.py">
+      <file leaf-file-name="common_flags.py" pinned="false" current-in-tab="false">
+        <entry file="file://$PROJECT_DIR$/common_flags.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="18">
-              <caret line="2" column="0" lean-forward="false" selection-start-line="2" selection-start-column="0" selection-end-line="2" selection-end-column="0" />
+            <state relative-caret-position="324">
+              <caret line="18" column="33" lean-forward="false" selection-start-line="18" selection-start-column="33" selection-end-line="18" selection-end-column="33" />
               <folding />
             </state>
           </provider>
         </entry>
       </file>
-      <file leaf-file-name="convolutional.py" pinned="false" current-in-tab="false">
-        <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/layers/convolutional.py">
+      <file leaf-file-name="darknet_flags.py" pinned="false" current-in-tab="false">
+        <entry file="file://$PROJECT_DIR$/darknet_flags.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="308">
-              <caret line="428" column="8" lean-forward="false" selection-start-line="428" selection-start-column="8" selection-end-line="428" selection-end-column="8" />
-              <folding />
-            </state>
-          </provider>
-        </entry>
-      </file>
-      <file leaf-file-name="common_flags.py" pinned="false" current-in-tab="false">
-        <entry file="file://$PROJECT_DIR$/common_flags.py">
-          <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="180">
-              <caret line="10" column="29" lean-forward="true" selection-start-line="10" selection-start-column="29" selection-end-line="10" selection-end-column="29" />
+            <state relative-caret-position="414">
+              <caret line="23" column="40" lean-forward="false" selection-start-line="23" selection-start-column="22" selection-end-line="23" selection-end-column="40" />
               <folding />
             </state>
           </provider>
@@ -141,14 +122,17 @@
       <find>DroneDirectoryIterator</find>
       <find>directory</find>
       <find>image_data_generator</find>
-      <find>experiment_rootdir</find>
       <find>alph</find>
       <find>json_model_fname</find>
       <find>squeeze_dims</find>
       <find>steerings_filename</find>
       <find>output_dim</find>
       <find>fit_generator</find>
+      <find>restore_model</find>
       <find>writeBestModel</find>
+      <find>experiment_rootdir</find>
+      <find>cnn_models</find>
+      <find>weights_path</find>
     </findStrings>
   </component>
   <component name="Git.Settings">
@@ -160,10 +144,12 @@
         <option value="$PROJECT_DIR$/data_preprocessing/time_stamp_matching.py" />
         <option value="$PROJECT_DIR$/utils.py" />
         <option value="$PROJECT_DIR$/cnn_models.py" />
-        <option value="$PROJECT_DIR$/darknet_models.py" />
         <option value="$PROJECT_DIR$/cnn.py" />
-        <option value="$PROJECT_DIR$/run_this.sh" />
         <option value="$PROJECT_DIR$/common_flags.py" />
+        <option value="$PROJECT_DIR$/darknet_flags.py" />
+        <option value="$PROJECT_DIR$/darknet_cnn.py" />
+        <option value="$PROJECT_DIR$/run_this.sh" />
+        <option value="$PROJECT_DIR$/darknet_models.py" />
       </list>
     </option>
   </component>
@@ -173,8 +159,8 @@
     <detection-done>true</detection-done>
     <sorting>DEFINITION_ORDER</sorting>
   </component>
-  <component name="ProjectFrameBounds" extendedState="6">
-    <option name="x" value="992" />
+  <component name="ProjectFrameBounds" extendedState="4">
+    <option name="x" value="65" />
     <option name="y" value="24" />
     <option name="width" value="928" />
     <option name="height" value="1056" />
@@ -238,11 +224,15 @@
   <component name="PropertiesComponent">
     <property name="settings.editor.selected.configurable" value="preferences.keymap" />
     <property name="WebServerToolWindowFactoryState" value="false" />
-    <property name="last_opened_file_path" value="$PROJECT_DIR$" />
+    <property name="last_opened_file_path" value="$PROJECT_DIR$/../keras-yolo3" />
   </component>
   <component name="RecentsManager">
+    <key name="MoveFile.RECENT_KEYS">
+      <recent name="$PROJECT_DIR$" />
+    </key>
     <key name="CopyFile.RECENT_KEYS">
       <recent name="$PROJECT_DIR$" />
+      <recent name="$PROJECT_DIR$/model" />
     </key>
   </component>
   <component name="RunDashboard">
@@ -323,7 +313,7 @@
     <servers />
   </component>
   <component name="ToolWindowManager">
-    <frame x="65" y="-4" width="1855" height="1084" extended-state="6" />
+    <frame x="65" y="24" width="928" height="1056" extended-state="4" />
     <editor active="true" />
     <layout>
       <window_info id="TODO" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="true" weight="0.33" sideWeight="0.5" order="6" side_tool="false" content_ui="tabs" />
@@ -332,7 +322,7 @@
       <window_info id="Version Control" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="true" weight="0.33" sideWeight="0.5" order="11" side_tool="false" content_ui="tabs" />
       <window_info id="Python Console" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="true" weight="0.33" sideWeight="0.5" order="8" side_tool="false" content_ui="tabs" />
       <window_info id="Terminal" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="true" weight="0.33" sideWeight="0.5" order="9" side_tool="false" content_ui="tabs" />
-      <window_info id="Project" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="true" show_stripe_button="true" weight="0.14986522" sideWeight="0.5" order="0" side_tool="false" content_ui="combo" />
+      <window_info id="Project" active="false" anchor="left" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="true" show_stripe_button="true" weight="0.32219827" sideWeight="0.5" order="0" side_tool="false" content_ui="combo" />
       <window_info id="Docker" active="false" anchor="bottom" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="false" weight="0.33" sideWeight="0.5" order="10" side_tool="false" content_ui="tabs" />
       <window_info id="Database" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="true" weight="0.33" sideWeight="0.5" order="3" side_tool="false" content_ui="tabs" />
       <window_info id="SciView" active="false" anchor="right" auto_hide="false" internal_type="DOCKED" type="DOCKED" visible="false" show_stripe_button="true" weight="0.33" sideWeight="0.5" order="4" side_tool="false" content_ui="tabs" />
@@ -356,26 +346,11 @@
   </component>
   <component name="XDebuggerManager">
     <breakpoint-manager>
-      <option name="time" value="1" />
+      <option name="time" value="2" />
     </breakpoint-manager>
     <watches-manager />
   </component>
   <component name="editorHistoryManager">
-    <entry file="file://$PROJECT_DIR$/constants.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="0">
-          <caret line="0" column="0" lean-forward="false" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />
-          <folding />
-        </state>
-      </provider>
-    </entry>
-    <entry file="file://$PROJECT_DIR$/img_utils.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="0">
-          <caret line="0" column="0" lean-forward="false" selection-start-line="0" selection-start-column="0" selection-end-line="0" selection-end-column="0" />
-        </state>
-      </provider>
-    </entry>
     <entry file="file://$PROJECT_DIR$/log_utils.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="324">
@@ -665,24 +640,6 @@
         </state>
       </provider>
     </entry>
-    <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/layers/convolutional.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="308">
-          <caret line="428" column="8" lean-forward="false" selection-start-line="428" selection-start-column="8" selection-end-line="428" selection-end-column="8" />
-          <folding />
-        </state>
-      </provider>
-    </entry>
-    <entry file="file://$PROJECT_DIR$/utils.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="837">
-          <caret line="338" column="18" lean-forward="false" selection-start-line="338" selection-start-column="12" selection-end-line="338" selection-end-column="18" />
-          <folding>
-            <element signature="e#38#47#0" expanded="true" />
-          </folding>
-        </state>
-      </provider>
-    </entry>
     <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/activations.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="18">
@@ -707,48 +664,84 @@
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/darknet_models.py">
+    <entry file="file:///usr/local/lib/python3.5/dist-packages/keras/layers/convolutional.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="1226">
+          <caret line="428" column="8" lean-forward="false" selection-start-line="428" selection-start-column="8" selection-end-line="428" selection-end-column="8" />
+          <folding />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/common_flags.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="324">
+          <caret line="18" column="33" lean-forward="false" selection-start-line="18" selection-start-column="33" selection-end-line="18" selection-end-column="33" />
+          <folding />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/darknet_flags.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="414">
+          <caret line="23" column="40" lean-forward="false" selection-start-line="23" selection-start-column="22" selection-end-line="23" selection-end-column="40" />
+          <folding />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/cnn.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="1440">
-          <caret line="80" column="20" lean-forward="false" selection-start-line="80" selection-start-column="20" selection-end-line="80" selection-end-column="20" />
+        <state relative-caret-position="2880">
+          <caret line="160" column="59" lean-forward="false" selection-start-line="160" selection-start-column="41" selection-end-line="160" selection-end-column="59" />
           <folding>
-            <element signature="e#0#12#0" expanded="true" />
+            <element signature="e#38#61#0" expanded="true" />
           </folding>
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/cnn_models.py">
+    <entry file="file://$PROJECT_DIR$/darknet_cnn.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="162">
-          <caret line="9" column="6" lean-forward="false" selection-start-line="9" selection-start-column="6" selection-end-line="9" selection-end-column="6" />
+        <state relative-caret-position="-348">
+          <caret line="46" column="4" lean-forward="false" selection-start-line="46" selection-start-column="4" selection-end-line="46" selection-end-column="4" />
           <folding>
-            <element signature="e#0#12#0" expanded="true" />
+            <element signature="e#38#61#0" expanded="true" />
           </folding>
         </state>
       </provider>
     </entry>
     <entry file="file://$PROJECT_DIR$/run_this.sh">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="108">
-          <caret line="6" column="13" lean-forward="false" selection-start-line="6" selection-start-column="13" selection-end-line="6" selection-end-column="13" />
+        <state relative-caret-position="180">
+          <caret line="10" column="21" lean-forward="false" selection-start-line="10" selection-start-column="21" selection-end-line="10" selection-end-column="21" />
           <folding />
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/common_flags.py">
+    <entry file="file://$PROJECT_DIR$/cnn_models.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="180">
-          <caret line="10" column="29" lean-forward="true" selection-start-line="10" selection-start-column="29" selection-end-line="10" selection-end-column="29" />
-          <folding />
+        <state relative-caret-position="594">
+          <caret line="33" column="45" lean-forward="false" selection-start-line="33" selection-start-column="36" selection-end-line="33" selection-end-column="45" />
+          <folding>
+            <element signature="e#0#12#0" expanded="true" />
+          </folding>
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/cnn.py">
+    <entry file="file://$PROJECT_DIR$/utils.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="378">
-          <caret line="87" column="46" lean-forward="true" selection-start-line="87" selection-start-column="46" selection-end-line="87" selection-end-column="46" />
+        <state relative-caret-position="0">
+          <caret line="0" column="0" lean-forward="false" selection-start-line="0" selection-start-column="0" selection-end-line="1" selection-end-column="14" />
           <folding>
-            <element signature="e#38#61#0" expanded="true" />
+            <element signature="e#38#47#0" expanded="true" />
+          </folding>
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/darknet_models.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="936">
+          <caret line="79" column="61" lean-forward="false" selection-start-line="79" selection-start-column="61" selection-end-line="79" selection-end-column="61" />
+          <folding>
+            <element signature="e#38#50#0" expanded="true" />
           </folding>
         </state>
       </provider>
diff --git a/common_flags.py b/common_flags.py
index 2851f61..dcc6636 100644
--- a/common_flags.py
+++ b/common_flags.py
@@ -16,7 +16,7 @@ gflags.DEFINE_string('img_mode', "grayscale", 'Load mode for images, either '
 
 # Training
 gflags.DEFINE_integer('batch_size', 64, 'Batch size in training and evaluation')
-gflags.DEFINE_integer('epochs', 200, 'Number of epochs for training')
+gflags.DEFINE_integer('epochs', 100, 'Number of epochs for training')
 gflags.DEFINE_integer('log_rate', 10, 'Logging rate for full model (epochs)')
 gflags.DEFINE_integer('initial_epoch', 0, 'Initial epoch to start training')
 
diff --git a/darknet_cnn.py b/darknet_cnn.py
index c430eb4..e2d4903 100644
--- a/darknet_cnn.py
+++ b/darknet_cnn.py
@@ -11,10 +11,10 @@ from keras.callbacks import ModelCheckpoint
 from keras import optimizers
 
 import logz
-import cnn_models
+import darknet_models
 import utils
 import log_utils
-from common_flags import FLAGS
+from darknet_flags import FLAGS
 from keras.callbacks import TensorBoard
 
 
@@ -32,7 +32,7 @@ def getModel(img_width, img_height, img_channels, output_dim, weights_path):
     # Returns
        model: A Model instance.
     """
-    model = cnn_models.resnet8(img_width, img_height, img_channels, output_dim)
+    model = darknet_models.darknet14(img_width, img_height, img_channels, output_dim)
 
     if weights_path:
         try:
diff --git a/darknet_flags.py b/darknet_flags.py
index dcc6636..ad590f6 100644
--- a/darknet_flags.py
+++ b/darknet_flags.py
@@ -5,23 +5,23 @@ import gflags
 FLAGS = gflags.FLAGS
 
 # Input
-gflags.DEFINE_integer('img_width', 320, 'Target Image Width')
-gflags.DEFINE_integer('img_height', 240, 'Target Image Height')
+gflags.DEFINE_integer('img_width', 480, 'Target Image Width')
+gflags.DEFINE_integer('img_height', 360, 'Target Image Height')
 
-gflags.DEFINE_integer('crop_img_width', 200, 'Cropped image widht')
-gflags.DEFINE_integer('crop_img_height', 200, 'Cropped image height')
+gflags.DEFINE_integer('crop_img_width', 320, 'Cropped image widht')
+gflags.DEFINE_integer('crop_img_height', 320, 'Cropped image height')
 
-gflags.DEFINE_string('img_mode', "grayscale", 'Load mode for images, either '
+gflags.DEFINE_string('img_mode', "rgb", 'Load mode for images, either '
                      'rgb or grayscale')
 
 # Training
 gflags.DEFINE_integer('batch_size', 64, 'Batch size in training and evaluation')
-gflags.DEFINE_integer('epochs', 100, 'Number of epochs for training')
+gflags.DEFINE_integer('epochs', 200, 'Number of epochs for training')
 gflags.DEFINE_integer('log_rate', 10, 'Logging rate for full model (epochs)')
 gflags.DEFINE_integer('initial_epoch', 0, 'Initial epoch to start training')
 
 # Files
-gflags.DEFINE_string('experiment_rootdir', "/home/zq610/WYZ/deeplearning/network/rpg_public_dronet/model", 'Folder '
+gflags.DEFINE_string('experiment_rootdir', "/home/zq610/WYZ/deeplearning/network/rpg_public_dronet/darknet14", 'Folder '
                      ' containing all the logs, model weights and results')
 gflags.DEFINE_string('train_dir', "/media/zq610/2C9BDE0469DC4DFC/ubuntu/dl_dataset/Dornet/training", 'Folder containing'
                      ' training experiments')
@@ -29,11 +29,11 @@ gflags.DEFINE_string('val_dir', "/media/zq610/2C9BDE0469DC4DFC/ubuntu/dl_dataset
                      ' validation experiments')
 gflags.DEFINE_string('test_dir', "/media/zq610/2C9BDE0469DC4DFC/ubuntu/dl_dataset/Dornet/testing", 'Folder containing'
                      ' testing experiments')
-gflags.DEFINE_string('log_dir', "/home/zq610/WYZ/deeplearning/network/rpg_public_dronet/logs/test", 'Folder containing'
+gflags.DEFINE_string('log_dir', "/home/zq610/WYZ/deeplearning/network/rpg_public_dronet/logs/darknet", 'Folder containing'
                      ' training logs')
 
 # Model
-gflags.DEFINE_bool('restore_model', True, 'Whether to restore a trained'
+gflags.DEFINE_bool('restore_model', False, 'Whether to restore a trained'
                    ' model for training')
 gflags.DEFINE_string('weights_fname', "model_weights.h5", '(Relative) '
                                           'filename of model weights')
diff --git a/darknet_models.py b/darknet_models.py
index 9bde3b0..e8bd508 100644
--- a/darknet_models.py
+++ b/darknet_models.py
@@ -1,3 +1,6 @@
+#!usr/bin/env python2
+#!coding=utf-8
+
 import keras
 from keras.models import Model
 from keras.layers import Dense, Dropout, Activation, Flatten, Input
@@ -26,7 +29,7 @@ def compose(*funcs):
 @wraps(Conv2D)
 def DarknetConv2D(*args, **kwargs):
     """Wrapper to set Darknet parameters for Convolution2D."""
-    darknet_conv_kwargs = {'kernel_regularizer': l2(5e-4)}
+    darknet_conv_kwargs = {'kernel_regularizer': l2(5e-4), 'kernel_initializer': "he_normal"}
     darknet_conv_kwargs['padding'] = 'valid' if kwargs.get('strides')==(2,2) else 'same'
     darknet_conv_kwargs.update(kwargs)
     return Conv2D(*args, **darknet_conv_kwargs)
@@ -74,8 +77,8 @@ def darknet14(img_width, img_height, img_channels, output_dim):
             MaxPooling2D(pool_size=(2,2), strides=(1,1), padding='same'),
             DarknetConv2D_BN_Leaky(1024, (3,3)),
             DarknetConv2D_BN_Leaky(256, (1,1)))(x1)
-    middle = DarknetConv2D_BN_Leaky(256, (1,1))(x1)
-    x3 = add(x2, middle)
+    middle = DarknetConv2D_BN_Leaky(256, (1,1), strides=(2,2))(x1)
+    x3 = add([x2, middle])
     x4 = DarknetConv2D_BN_Leaky(128, (1, 1))(x3)
 
     x = Flatten()(x4)
diff --git a/run_this.sh b/run_this.sh
index a921969..1da8f6c 100755
--- a/run_this.sh
+++ b/run_this.sh
@@ -4,4 +4,9 @@
 #python3 evaluation.py --experiment_ootdir='./model' --weights_fname='model_weights.h5' --test_dir='/media/zq610/2C9BDE0469DC4DFC/ubuntu/dl_dataset/Dornet/validation'
 #python3 evaluation.py
 
-python cnn.py
+# original train file
+#python cnn.py
+
+# darknet file train file
+python darknet_cnn.py
+
